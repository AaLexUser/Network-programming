# 4. Что такое NAT и как он работает?
```{glossary}
NAT (Network Address Translation)
    это технология преобразования сетевых адресов, которая позволяет нескольким устройствам в локальной сети (LAN) выходить в интернет, используя один или несколько внешних (публичных) IP-адресов.
```
---

### Виды NAT
Статический (Static NAT)
: Один внутренний IP-адрес напрямую и постоянно привязан к одному внешнему IP-адресу.

Динамический (Dynamic NAT)
: Внутренние IP-адреса (из некоторого пула) по требованию сопоставляются со свободными публичными адресами (из внешнего пула).

PAT (Port Address Translation) / NAT Overload
: Один внешний IP-адрес может обслуживать множество внутренних адресов, отличая их по разным портам источника.

---

### Принцип работы:

1. Устройство в сети отправляет пакет на внешний ресурс.
2. Маршрутизатор принимает этот пакет, заменяет IP-адрес отправителя (и порт) на свой внешний адрес (и выделяет уникальный порт).
3. Интернет-ресурс отвечает на этот внешний адрес/порт.
4. Маршрутизатор смотрит в таблицу трансляции и перенаправляет ответ во внутреннюю сеть, восстанавливая исходные адреса и порты.

---

Таблица трансляции
: Маршрутизатор ведёт специальную таблицу трансляции (NAT-таблицу), в которой хранит информацию о том, какой внутренний IP-адрес и порт (в сочетании называемые сокетом) сопоставляются какому внешнему IP-адресу и порту.

- При отправке пакета из локальной сети NAT «подменяет» (транслирует) источник IP-адреса и порт на публичный IP-адрес и некий свободный порт.
- При получении ответа снаружи (в интернет) маршрутизатор читает адрес и порт назначения, ищет совпадение в таблице трансляции и перенаправляет трафик на нужный внутренний IP-адрес, восстанавливая оригинальные параметры.

---

**Частные (private) адреса и публичный (public) адрес**

- Внутренние IP-адреса (например, 192.168.0.x, 10.0.0.x и т. д.) не могут напрямую обращаться к ресурсам в интернете, поскольку они не маршрутизируются глобально.
- Для выхода в интернет используется маршрутизатор, на котором настроен NAT. Он имеет как минимум один публичный IP-адрес.
